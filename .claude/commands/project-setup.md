---
allowed-tools: [Read(**), Edit(**), Write(**), LS(**)]
description: 根据需求生成或完善项目的 PLANNING.md 和 TASK.md 文件
---

# 项目规划与任务设置命令

## 功能描述
根据用户输入的需求，智能生成或完善项目的 PLANNING.md（项目规划）和 TASK.md（任务跟踪）文件。支持从零创建或在现有文件基础上进行增强。

## 参数说明
`$ARGUMENTS` 为项目需求描述，可以包含：
- 项目目标和功能描述
- 技术架构要求
- 编码风格和约束条件
- 具体的开发任务需求

如果 `$ARGUMENTS` 为空，命令将进入交互模式，引导用户输入项目信息。

## 使用示例
```bash
/project-setup "创建一个机器学习项目，使用PyTorch框架，包含数据处理、模型训练和推理功能"
/project-setup "添加API服务开发任务，使用FastAPI框架"
/project-setup  # 交互模式
```

## 执行步骤

### 1. 项目状态检查
首先检查当前项目目录中是否已存在 PLANNING.md 和 TASK.md 文件：
- 如果存在，读取现有内容作为基础
- 如果不存在，准备创建新文件

### 2. 需求分析
解析用户输入的 `$ARGUMENTS`，提取以下信息：
- **项目目标**: 主要功能和目的
- **技术栈**: 使用的框架、库和工具
- **架构模式**: 代码组织结构和设计模式
- **开发约束**: 编码规范、测试要求等
- **任务范围**: 具体需要完成的开发任务

### 3. PLANNING.md 生成/完善
基于需求分析结果，生成或更新 PLANNING.md 文件，包含：

```markdown
# 项目规划：[项目名称]

## 1. 项目目标
[根据需求描述项目的主要目标和价值]

## 2. 技术架构
### 2.1. 目录结构
[定义清晰的模块化目录结构]

### 2.2. 核心组件
[描述主要技术组件和其职责]

## 3. 编码风格与约束
[定义开发规范，遵循CLAUDE.md中的指导原则]

## 4. 约束条件
[列出技术和业务约束]

## 5. 自动化工具与命令
[项目特定的工具和命令配置]
```

### 4. TASK.md 生成/更新
基于需求生成新的任务项目，追加到现有 TASK.md 文件中：

```markdown
## 任务: [任务标题]
**提出时间:** [当前日期]
**状态:** 规划中

### 背景:
[任务的背景描述和目标]

### TODO:
*   [ ] [留白，等待具体细化]
```

### 5. 智能内容生成
根据识别的项目类型和技术栈，自动包含相关的最佳实践：
- **机器学习项目**: 数据处理、模型训练、评估模块
- **Web应用**: API设计、数据库、前端集成
- **工具开发**: CLI接口、配置管理、测试框架
- **库开发**: 接口设计、文档、示例代码

### 6. 一致性检查
确保生成的文档符合项目规范：
- 遵循 CLAUDE.md 中定义的代码风格
- 保持与现有项目架构的一致性
- 验证技术栈的兼容性

## 输出格式

### 成功场景
```
✅ PLANNING.md 已生成/更新
   - 项目目标: [简要描述]
   - 技术架构: [主要组件]
   - 新增约束: [X个]

✅ TASK.md 已更新
   - 新增任务: "[任务标题]"
   - 提出时间: [日期]
   - 状态: 规划中

📋 建议下一步:
   - 细化 TODO 列表
   - 创建初始目录结构
   - 配置开发环境
```

### 错误处理
- 如果无法解析需求描述，提供具体的改进建议
- 如果技术栈冲突，列出冲突项并建议解决方案
- 如果文件权限问题，提供明确的操作指导

## 特殊功能

### 交互模式
当 `$ARGUMENTS` 为空时，命令进入交互模式：
1. 询问项目类型（Web应用、机器学习、工具开发等）
2. 确认技术栈选择
3. 收集特殊要求和约束
4. 基于收集的信息生成文档

### 模板库
内置常见项目类型的模板：
- **机器学习项目模板**: 包含数据、模型、训练、评估模块
- **Web服务模板**: 包含API、数据库、认证、部署配置
- **工具开发模板**: 包含CLI、配置、测试、文档结构
- **库开发模板**: 包含核心功能、测试、示例、文档

### 增量更新
支持在现有项目基础上添加新功能：
- 自动检测现有架构模式
- 保持命名约定的一致性
- 智能合并新需求到现有结构中

## 最佳实践

1. **需求描述清晰**: 提供具体的功能要求和技术偏好
2. **渐进式完善**: 先建立基础架构，再逐步添加复杂功能
3. **文档同步**: 确保 PLANNING.md 和实际代码结构保持一致
4. **定期回顾**: 随着项目发展及时更新规划文档

此命令旨在帮助开发者快速建立结构化的项目规划，提高开发效率和代码质量。